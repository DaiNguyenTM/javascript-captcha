{"version":3,"file":"helpers.js","names":["getBaseUrlFromUrl","url","baseUrl","indexOf","urlParts","split","getClientBaseUrl","window","location","href","detectIE9","detected","navigator","userAgent","parts","version","parseInt","detectCrossDomainRequest","backendUrl","clientBaseUrl","backendBaseUrl","httpGetWithXMLHttpRequest","successCallback","errorCallback","xhr","XMLHttpRequest","onreadystatechange","readyState","status","responseText","addEventListener","open","send","httpGetWithXDomainRequest","console","log","xdr","XDomainRequest","onprogress","onload","onerror","setTimeout","getCaptchaEndpointHandler","configuredCaptchaEndpointUrl","splited","length","getBackendBaseUrl","captchaEndpointHandler","lastIndex","lastIndexOf","substring","helpers","string","format","str","arguments","index","regex","RegExp","replace","time","currentTimestamp","currentTime","Date","now","getTime","sanitizer","sanitize","input","dom","createScriptElement","id","source","callback","script","document","createElement","src","object","mergeObjects","target","merged","key","value","isEmptyObject","obj","hasOwnProperty","ajax","get","createUrl","params","p","pKey","pValue","push","paramsPattern","test","join","changeRelativeToAbsoluteUrls","originalCaptchaHtml","relativeUrls","match","relativeUrl","absoluteUrl","changedCaptchaHtml","i","slice","_default","exports"],"sources":["../../../src_temp/cjs_build_src/es6/helpers.js"],"sourcesContent":["/*\r\nCopyright Captcha, Inc. 2004-2023. All rights reserved.\r\n\r\nBotDetect, BotDetect CAPTCHA, Lanap, Lanap CAPTCHA, Lanap BotDetect, \r\nLanap BotDetect CAPTCHA, Lanapsoft, Lanapsoft CAPTCHA, \r\nLanapsoft BotDetect, Lanapsoft BotDetect CAPTCHA, and Lanap Software \r\nare trademarks of Captcha, Inc. All other product, brand, and company \r\nnames are mentioned for identification purposes only and are trademarks \r\nor registered trademarks of their respective owners.\r\n\r\nCaptcha, Inc. - formerly: Lanapsoft, Inc. / Lanap, Inc.\r\n*/\r\n\r\nfunction getBaseUrlFromUrl(url) {\r\n  let baseUrl = null;\r\n  if (url.indexOf('http') === 0) {\r\n    const urlParts = url.split('/');\r\n    baseUrl = urlParts[0] + '//' + urlParts[2];\r\n  }\r\n  return baseUrl;\r\n}\r\n\r\nfunction getClientBaseUrl() {\r\n  const url = window.location.href;\r\n  const baseUrl = getBaseUrlFromUrl(url);\r\n  return baseUrl;\r\n}\r\n\r\nfunction detectIE9() {\r\n  let detected = false;\r\n  if (navigator && navigator.userAgent) {\r\n    const userAgent = navigator.userAgent;\r\n    if (userAgent.indexOf('MSIE') !== -1) {\r\n      const parts = userAgent.split('MSIE');\r\n      const version = parseInt(parts[1]);\r\n      if (version === 9) {\r\n        detected = true;\r\n      }\r\n    }\r\n  }\r\n  return detected;\r\n}\r\n\r\nfunction detectCrossDomainRequest(backendUrl) {\r\n  let detected = false;\r\n  const clientBaseUrl = getClientBaseUrl();\r\n  const backendBaseUrl = getBaseUrlFromUrl(backendUrl);\r\n  if ((clientBaseUrl !== null) && (backendBaseUrl !== null) \r\n        && (clientBaseUrl !== backendBaseUrl)) {\r\n    detected = true;\r\n  }\r\n  return detected;\r\n}\r\n\r\nfunction httpGetWithXMLHttpRequest(url, successCallback, errorCallback) {\r\n  const xhr = new XMLHttpRequest();\r\n  xhr.onreadystatechange = function() {\r\n    if ((xhr.readyState === 4) && (xhr.status === 200)) {\r\n      successCallback(xhr.responseText);\r\n    }\r\n\r\n    if ((xhr.readyState === 4) && (xhr.status !== 200)) {\r\n      if (typeof errorCallback === 'function') {\r\n        errorCallback(xhr);\r\n      }\r\n    }\r\n  };\r\n  if (typeof errorCallback === 'function') {\r\n    xhr.addEventListener('error', function() {\r\n      errorCallback(xhr);\r\n    });\r\n  }\r\n  xhr.open('GET', url, true);\r\n  xhr.send();\r\n}\r\n\r\nfunction httpGetWithXDomainRequest(url, successCallback, errorCallback) {\r\n  console.log('IE9-crossdomain');\r\n  const xdr = new XDomainRequest();\r\n  xdr.open('GET', url);\r\n  xdr.onprogress = function() {};\r\n  xdr.onload = function() {\r\n    successCallback(xdr.responseText);\r\n  };\r\n  if (typeof errorCallback === 'function') {\r\n    xdr.onerror = function() {\r\n      errorCallback(xdr);\r\n    };\r\n  }\r\n  setTimeout(function() {\r\n    xdr.send();\r\n  }, 0);\r\n}\r\n\r\n// get captcha endpoint handler from configured captchaEndpointUrl value,\r\n// the expected result will be:\r\n// simple-captcha-endpoint.ashx -- for asp.net backend\r\n// simple-captcha-endpoint -- for java backend\r\n// simple-captcha-endpoint.php -- for php backend\r\n// or a custom path that user configured on backend\r\nfunction getCaptchaEndpointHandler(configuredCaptchaEndpointUrl) {\r\n  const splited = configuredCaptchaEndpointUrl.split('/');\r\n  return splited[splited.length - 1];\r\n}\r\n\r\n// get backend base url from configured captchaEndpointUrl value\r\nfunction getBackendBaseUrl(configuredCaptchaEndpointUrl, captchaEndpointHandler) {\r\n  let lastIndex = configuredCaptchaEndpointUrl.lastIndexOf(captchaEndpointHandler);\r\n  return configuredCaptchaEndpointUrl.substring(0, lastIndex);\r\n}\r\n\r\nconst helpers = {\r\n  string: {\r\n    format: function() {\r\n      let str = arguments[0];\r\n      for (const index in arguments) {\r\n        const regex = new RegExp(\"\\\\{\" + (index - 1) + \"\\\\}\", \"g\");\r\n        str = str.replace(regex, arguments[index]);\r\n      }\r\n      return str;\r\n    }\r\n  },\r\n\r\n  time: {\r\n    currentTimestamp: function() {\r\n      const currentTime = Date.now ? Date.now() : new Date().getTime();\r\n      return currentTime;\r\n    }\r\n  },\r\n\r\n  sanitizer: {\r\n    sanitize: function(input) {\r\n      input = input.replace(/[^a-zA-Z0-9\\.\\-\\_\\~\\!\\$\\&\\(\\)\\*\\+\\,\\;\\=\\:\\@\\%\\#\\/\\?]/gim, '');\r\n      return input;\r\n    }\r\n  },\r\n\r\n  dom: {\r\n    createScriptElement: function(id, source, callback) {\r\n      const script = document.createElement('script');\r\n      script.id = id;\r\n      script.src = source;\r\n    \r\n      if (typeof callback === 'function') {\r\n        script.onload = callback;\r\n      }\r\n            \r\n      return script;\r\n    }\r\n  },\r\n\r\n  object: {\r\n    mergeObjects: function(target, source) {\r\n      let merged = {};\r\n      for (let key in target) {\r\n        const value = source[key];\r\n        merged[key] = (value === void 0) ? target[key] : value;\r\n      }\r\n      return merged;\r\n    },\r\n\r\n    isEmptyObject: function(obj) {\r\n      if (obj) {\r\n        for (let key in obj) {\r\n          if (obj.hasOwnProperty(key)) {\r\n            return false;\r\n          }\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n  },\r\n\r\n  ajax: {\r\n    get: function(url, successCallback, errorCallback) {\r\n      if (detectIE9() && detectCrossDomainRequest(url)) {\r\n        // for cross-domain on IE9 support\r\n        httpGetWithXDomainRequest(url, successCallback, errorCallback);\r\n      } else {\r\n        httpGetWithXMLHttpRequest(url, successCallback, errorCallback);\r\n      }\r\n    }\r\n  },\r\n\r\n  url: {\r\n    createUrl(url, params) {\r\n      let p = [];\r\n      for (let pKey in params) {\r\n        if (typeof pKey === 'string') {\r\n          const pValue = params[pKey];\r\n          if ((pValue !== null) && (pValue !== '')) {\r\n            p.push(pKey + '=' + pValue);\r\n          }\r\n        }\r\n      }\r\n      const paramsPattern = /\\?+/g;\r\n      return paramsPattern.test(url) ? (url + '&' + p.join('&')) : (url + '?' + p.join('&')); \r\n    },\r\n\r\n    changeRelativeToAbsoluteUrls(originalCaptchaHtml, configuredCaptchaEndpointUrl) {\r\n      const captchaEndpointHandler = getCaptchaEndpointHandler(configuredCaptchaEndpointUrl);\r\n      const backendUrl = getBackendBaseUrl(configuredCaptchaEndpointUrl, captchaEndpointHandler);\r\n    \r\n      const relativeUrls = originalCaptchaHtml.match(/(src|href)=\\\"([^\"]+)\\\"/g);\r\n      let relativeUrl, absoluteUrl,\r\n          changedCaptchaHtml = originalCaptchaHtml;\r\n    \r\n      for (let i = 0; i < relativeUrls.length; i++) {\r\n        relativeUrl = relativeUrls[i].slice(0, -1).replace(/src=\\\"|href=\\\"/, '');\r\n        absoluteUrl = relativeUrl.replace(/.*\\?get=/, backendUrl + captchaEndpointHandler + '?get=');\r\n        changedCaptchaHtml = changedCaptchaHtml.replace(relativeUrl, absoluteUrl);\r\n      }\r\n    \r\n      return changedCaptchaHtml;\r\n    }\r\n  }\r\n\r\n}\r\n\r\nexport default helpers;\r\n"],"mappings":"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"}